<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pit Lane Kart Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #fff;
  padding: 10px;
}

section {
  margin-bottom: 20px;
}

button, select {
  padding: 6px;
  font-size: 14px;
}

.row {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  margin-bottom: 15px;
}

.kart-column {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.kart {
  width: 60px;
  height: 60px;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-size: 12px;
  border: 2px solid #000;
}

.blue { background:#3498db; }
.red { background:#e74c3c; }
.orange { background:#e67e22; }
.yellow { background:#f1c40f; color:#000; }
.green { background:#2ecc71; }
.purple { background:#9b59b6; }

.small {
  font-size: 10px;
}
</style>
</head>

<body>

<h2>Teams</h2>
<section id="teams"></section>

<h2>Pit Lane</h2>
<section id="pits"></section>

<script>
/* ---------- DATA ---------- */
const colors = ["blue","red","orange","yellow","green","purple"];

let teams = [];
let rows = [];

/* ---------- HELPERS ---------- */
function createColorSelect(current, onChange) {
  const sel = document.createElement("select");
  colors.forEach(c => {
    const o = document.createElement("option");
    o.value = c;
    o.textContent = c;
    if (c === current) o.selected = true;
    sel.appendChild(o);
  });
  sel.onchange = e => onChange(e.target.value);
  return sel;
}

/* ---------- SETUP ---------- */
function init() {
  // example initial setup (can be edited later)
  teams = [
    { name:"Team 1", kart:1, color:"blue" },
    { name:"Team 2", kart:2, color:"blue" },
    { name:"Team 3", kart:3, color:"blue" }
  ];

  rows = [
    [
      { kart:101, color:"blue" },
      { kart:102, color:"blue" },
      { kart:103, color:"blue" }
    ],
    [
      { kart:201, color:"blue" },
      { kart:202, color:"blue" },
      { kart:203, color:"blue" }
    ]
  ];

  render();
}

/* ---------- RENDER ---------- */
function render() {
  renderTeams();
  renderPits();
}

function renderTeams() {
  const el = document.getElementById("teams");
  el.innerHTML = "";

  teams.forEach(t => {
    const box = document.createElement("div");
    box.className = `kart ${t.color}`;
    box.innerHTML = `
      <b>${t.name}</b>
      <div class="small">Kart ${t.kart}</div>
    `;
    box.appendChild(
      createColorSelect(t.color, c => {
        t.color = c;
        render();
      })
    );
    el.appendChild(box);
  });
}

function renderPits() {
  const el = document.getElementById("pits");
  el.innerHTML = "";

  rows.forEach((row, rowIndex) => {
    const rowDiv = document.createElement("div");
    rowDiv.className = "row";

    const col = document.createElement("div");
    col.className = "kart-column";

    row.forEach(k => {
      const box = document.createElement("div");
      box.className = `kart ${k.color}`;
      box.innerHTML = `Kart ${k.kart}`;
      box.appendChild(
        createColorSelect(k.color, c => {
          k.color = c;
          render();
        })
      );
      col.appendChild(box);
    });

    const controls = document.createElement("div");

    const teamSelect = document.createElement("select");
    teams.forEach((t,i) => {
      const o = document.createElement("option");
      o.value = i;
      o.textContent = `${t.name} (Kart ${t.kart})`;
      teamSelect.appendChild(o);
    });

    const plus = document.createElement("button");
    plus.textContent = "+";
    plus.onclick = () => pitStop(rowIndex, parseInt(teamSelect.value));

    controls.appendChild(teamSelect);
    controls.appendChild(document.createElement("br"));
    controls.appendChild(plus);

    rowDiv.appendChild(col);
    rowDiv.appendChild(controls);
    el.appendChild(rowDiv);
  });
}

/* ---------- PIT LOGIC ---------- */
function pitStop(rowIndex, teamIndex) {
  const row = rows[rowIndex];
  const team = teams[teamIndex];

  // 1. team takes first kart
  const takenKart = row.shift();

  // 2. team leaves current kart at back
  row.push({
    kart: team.kart,
    color: team.color
  });

  // 3. team updates to new kart
  team.kart = takenKart.kart;
  team.color = takenKart.color;

  render();
}

init();
</script>

</body>
</html>
