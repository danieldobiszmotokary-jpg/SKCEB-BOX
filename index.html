<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pit Lane Kart Tracker</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#111;
  color:#eee;
  margin:0;
  padding:10px;
}

h2 {
  margin-top:20px;
}

section {
  border:1px solid #333;
  padding:10px;
  margin-bottom:15px;
  border-radius:8px;
}

button, select, input {
  font-size:16px;
  padding:6px;
  margin:4px 0;
}

.row-container {
  display:flex;
  gap:12px;
  overflow-x:auto;
}

.pit-row {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
}

.kart {
  width:50px;
  height:50px;
  border-radius:6px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  border:2px solid #000;
}

.team {
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:6px;
}

.color-picker {
  font-size:14px;
}

.blue { background:#1e90ff; }
.red { background:#c0392b; }
.orange { background:#e67e22; }
.yellow { background:#f1c40f; color:#000; }
.green { background:#27ae60; }
.purple { background:#8e44ad; }
</style>
</head>

<body>

<h1>Pit Lane Kart Tracker</h1>

<section>
<h2>1️⃣ Setup Teams</h2>
<input id="teamName" placeholder="Team name">
<input id="teamKart" placeholder="Kart number">
<button onclick="addTeam()">Add Team</button>
<div id="teamList"></div>
</section>

<section>
<h2>2️⃣ Setup Pit Rows</h2>
<label>Rows:</label>
<input id="rowCount" type="number" value="2">
<label>Karts per row:</label>
<input id="kartCount" type="number" value="3">
<button onclick="initPits()">Initialize Pits</button>
</section>

<section>
<h2>3️⃣ Pit Lane</h2>
<div class="row-container" id="pits"></div>
</section>

<script>
const COLORS = ["blue","red","orange","yellow","green","purple"];

let teams = [];
let pits = [];

// ---------- TEAMS ----------
function addTeam() {
  const name = teamName.value.trim();
  const kart = teamKart.value.trim();
  if(!name || !kart) return;

  teams.push({
    name,
    kart,
    color:"blue"
  });

  teamName.value="";
  teamKart.value="";
  renderTeams();
}

function renderTeams() {
  teamList.innerHTML="";
  teams.forEach((t,i)=>{
    const div=document.createElement("div");
    div.className="team";
    div.innerHTML=`
      <strong>${t.name}</strong> (#${t.kart})
      <div class="kart ${t.color}"></div>
      <select class="color-picker" onchange="setTeamColor(${i},this.value)">
        ${COLORS.map(c=>`<option ${c===t.color?"selected":""}>${c}</option>`).join("")}
      </select>
    `;
    teamList.appendChild(div);
  });
}

function setTeamColor(i,color){
  teams[i].color=color;
  renderTeams();
  renderPits();
}

// ---------- PITS ----------
function initPits() {
  pits=[];
  const rows=+rowCount.value;
  const karts=+kartCount.value;

  for(let r=0;r<rows;r++){
    pits.push(Array(karts).fill("blue"));
  }
  renderPits();
}

function renderPits() {
  pitsContainer = document.getElementById("pits");
  pitsContainer.innerHTML="";

  pits.forEach((row,rowIndex)=>{
    const col=document.createElement("div");
    col.className="pit-row";

    row.forEach((color,kIndex)=>{
      const k=document.createElement("div");
      k.className=`kart ${color}`;
      k.onclick=()=>changeKartColor(rowIndex,kIndex);
      col.appendChild(k);
    });

    const btn=document.createElement("button");
    btn.textContent="➕";
    btn.onclick=()=>pitAction(rowIndex);
    col.appendChild(btn);

    pitsContainer.appendChild(col);
  });
}

function changeKartColor(r,k){
  const current=pits[r][k];
  const next=COLORS[(COLORS.indexOf(current)+1)%COLORS.length];
  pits[r][k]=next;
  renderPits();
}

// ---------- PIT ACTION ----------
function pitAction(rowIndex){
  if(teams.length===0) return alert("Add teams first");

  const teamName = prompt(
    "Team entering pits:\n" +
    teams.map(t=>t.name).join(", ")
  );

  const team = teams.find(t=>t.name===teamName);
  if(!team) return;

  // team leaves current kart at back
  pits[rowIndex].push(team.color);

  // team takes front kart
  const newKart = pits[rowIndex].shift();
  team.color = newKart;

  renderTeams();
  renderPits();
}
</script>

</body>
</html>
